@namespace RepositoryFramework.Web.Components.Standard
@using Radzen.Blazor
@using Radzen;
@typeparam T
@typeparam TKey where TKey: notnull
@inherits RepositoryBase<T, TKey>

<RadzenDataGrid Data="@_entities"
                Count="@_totalItems"
                LoadData="@OnReadData"
                TItem="Entity<T, TKey>"
                AllowVirtualization="true"
                Style="@_tableWidth"
                AllowFiltering="true"
                FilterCaseSensitivity="FilterCaseSensitivity.Default"
                LogicalFilterOperator="LogicalFilterOperator.Or"
                AllowPaging="true"
                AllowSorting="true">
    <Columns>
        <RadzenDataGridColumn TItem="Entity<T, TKey>" Property="Key" Title="Key">
            <Template Context="context">
                <RadzenLink Path="@GetEditUri(context.Key!)" Text="@GetKey(context)" />
            </Template>
        </RadzenDataGridColumn>
        @foreach (var value in TypeShowcase.FlatProperties)
        {
            if (value.Type != PropertyType.Enumerable)
            {
                <RadzenDataGridColumn TItem="Entity<T, TKey>" Property="@GetRealNavigationPath(value.NavigationPath)" Title="@value.Self.Name" Sortable="true" />
            }
            else
            {
                <RadzenDataGridColumn TItem="Entity<T, TKey>" Property="@GetRealNavigationPath(value.NavigationPath)" Title="@value.Self.Name" Sortable="true" Filterable="false">
                    <Template Context="context">
                        @OpenEnumerableVisualizer(context!.Value, value)
                    </Template>
                </RadzenDataGridColumn>
            }
        }
    </Columns>
</RadzenDataGrid>

